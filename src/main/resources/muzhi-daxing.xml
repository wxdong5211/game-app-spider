<?xml version="1.0" encoding="UTF-8"?>
<tasks host="http://www.muzhiwan.com/" boot="catalog">

    <task id="catalog" uri="category/24/">
        <blocks select=".pt10 li" index="4:" task-ref="apps">
            <prop name="catalog" vtype="const" const="大型"/>
            <prop name="from" vtype="const" const="muzhi"/>
            <context name="catalogVar" select="a" subStart="-" subEnd="-" attr="href" vtype="attr"/>
        </blocks>
    </task>

    <task id="apps" uri="category/24/new-${catalogVar}-0-${appPageNum}.html" page-var="appPageNum" thread="true" new-client="true">
        <max-page select=".paging a" subStart="0-" subEnd="." index="-2" vtype="attr" attr="href"/>
        <blocks select=".biglist li" task-ref="detail">
            <prop name="id" vtype="uuid"/>
            <prop name="subCatalog" select=".inrto a" index="first" vtype="text"/>
            <prop name="name" select=".namelink a" attr="data_name" vtype="text"/>
            <prop name="logo" select=".mt5 img" attr="lazy-src" vtype="attr"/>
            <prop name="uri" select=".inrto a" index="last" attr="href" vtype="attr"/>
            <prop name="createTime" vtype="datetime"/>
            <context name="detailPageUri" select=".namelink a" attr="href" vtype="attr"/>
            <prop-output target="/data/muzhi/${catalog}/${subCatalog}/appattrs.sql" newline="true">
                INSERT INTO `appattrs` (`id`,`aid`,`snap`) VALUES('${name}','${logo}','${uri}');
            </prop-output>
        </blocks>
    </task>

    <task id="detail" uri="${detailPageUri}">
        <!--<blocks select=".content-main" task-ref="comment">
            <prop name="version" select=".quickdown" attr="data_versionname" vtype="attr"/>
            <prop name="times" select=".app-meta .down" vtype="text"/>
            <prop name="stars" select=".app-meta .star>span" attr="style" vtype="attr"/>
            <prop name="datetime" select=".name" vtype="text"/>
            <prop name="company" select=".origin" vtype="text"/>
            <prop name="description" select=".brief-long" vtype="text"/>
            <context name="commentId" select="input[name=groupid]" attr="value" vtype="attr"/>
            <prop-output target="/data/baidu/${catalog}/${subCatalog}/apps.sql" newline="true">
                INSERT INTO `apps` (`id`,`name`,`catalog`,`subCatalog`,`logo`,`version`,`company`,`uri`,`times`,`stars`,`description`,`from`,`createTime`) VALUES('${id}','${sql:name}','${catalog}','${subCatalog}','${logo}','${version}','${sql:company}','${uri}','${times}','${stars}','${sql:description}','${from}','${createTime}');
            </prop-output>
            <blocks select=".screenshot-container img">
                <prop name="attrId" vtype="uuid"/>
                <prop name="snap" attr="src" vtype="attr"/>
                <prop-output target="/data/baidu/${catalog}/${subCatalog}/appattrs.sql" newline="true">
                    INSERT INTO `appattrs` (`id`,`aid`,`snap`) VALUES('${attrId}','${id}','${snap}');
                </prop-output>
            </blocks>
        </blocks>-->
    </task>

    <!--<task id="comment" uri="comment?action_type=getCommentList&amp;groupid=${commentId}" page-param="pn">
        <max-page select="input[name=totalpage]" attr="value" vtype="attr" max="10"/>
        <blocks select=".comment">
            <prop name="commentId" vtype="uuid"/>
            <prop name="user" select=".comment-info em" vtype="text"/>
            <prop name="comment" select=".comment-info p" vtype="text"/>
            <prop name="commentTime" select=".comment-time" vtype="text"/>
            <prop-output target="/data/baidu/${catalog}/${subCatalog}/appcomments.sql" newline="true">
                INSERT INTO `appcomments`(`id`,`aid`,`user`,`comment`,`datetime`) VALUES ('${commentId}','${id}','${sql:user}','${sql:comment}','${commentTime}');
            </prop-output>
        </blocks>
    </task>-->

</tasks>